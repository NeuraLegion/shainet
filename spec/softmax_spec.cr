require "./spec_helper"
require "csv"

describe SHAInet::CNN do
  puts "############################################################"
  it "Test softmax layer" do
    puts "\n"
    img_data = [
      [[1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0],
       [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0],
       [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0],
       [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0],
       [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0],
       [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0],
       [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0]],

      [[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
       [2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0],
       [3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0],
       [4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0],
       [5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0],
       [6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0],
       [7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0]],
    ]

    cnn = SHAInet::CNN.new
    cnn.add_input(volume = [7, 7, 2])

    cnn.add_fconnect(10, SHAInet.sigmoid)
    cnn.add_softmax((0..-3))

    cnn.run(img_data, stealth: false)
  end
end
